<!DOCTYPE html>
<html>
<head>
    <title>Shelves - Tools a Cowboy Would Use</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600;700&family=Inter:wght@300;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        html, body {
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            font-family: 'EB Garamond', serif;
            overflow-x: hidden;
            width: 100%;
            min-height: 100vh;
        }

        .header {
            position: sticky;
            top: 0;
            background-color: #ffffff;
            border-bottom: 2px solid #000;
            z-index: 100;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-family: 'EB Garamond', serif;
            font-size: 32px;
            font-weight: 700;
            margin: 0;
            color: #000;
        }

        .back-link {
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #000;
            text-decoration: none;
            padding: 12px 20px;
            border: 2px solid #000;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .back-link:hover {
            background-color: #000;
            color: #fff;
        }

        /* Hero Section */
        .hero-section {
            background-color: #ffffff;
            min-height: 100vh;
            position: relative;
        }

        .hero-section.color-dark {
            background-color: #1a1a1a;
        }

        .hero-section.color-beige {
            background-color: #F5F1E8;
        }

        .hero-section.color-green {
            background-color: #1F2C26;
        }

        .hero-section.color-navy {
            background-color: #001E32;
        }

        .navigation-bar {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            display: flex;
            align-items: stretch;
            gap: 0;
            padding: 0;
            background: none;
            border: none;
        }

        .nav-row-top, .nav-row-bottom {
            display: contents;
        }

        .color-spinner-container {
            position: relative;
            z-index: 10;
        }

        .color-spinner {
            display: flex;
            align-items: center;
            gap: 6px;
            background:
                linear-gradient(145deg, #52221F 0%, #34151A 50%, #1E0C0F 100%),
                linear-gradient(90deg, transparent 46%, rgba(74, 31, 31, 0.7) 50%, transparent 54%),
                linear-gradient(0deg, transparent 47%, rgba(47, 19, 24, 0.6) 50%, transparent 53%),
                linear-gradient(135deg, transparent 45%, rgba(90, 35, 25, 0.4) 50%, transparent 55%),
                linear-gradient(67deg, transparent 48%, rgba(30, 12, 8, 0.8) 52%, transparent 56%);
            background-size: 100% 100%, 2px 2px, 4px 4px, 8px 8px, 16px 16px;
            padding: 12px 16px;
            border: 2px solid;
            border-top-color: rgba(90, 45, 35, 0.9);
            border-left-color: rgba(90, 45, 35, 0.9);
            border-right-color: rgba(26, 11, 14, 1);
            border-bottom-color: rgba(26, 11, 14, 1);
            box-shadow:
                inset 0 1px 1px rgba(120, 60, 45, 0.4),
                inset 0 -1px 2px rgba(26, 11, 14, 0.6),
                2px 2px 6px 1px rgba(47, 19, 24, 0.4);
            border-radius: 0;
        }

        .color-circle {
            position: relative;
            width: 28px;
            height: 28px;
            border-radius: 0px;
            cursor: pointer;
            border: 2px solid;
            border-top-color: rgba(90, 45, 35, 1);
            border-left-color: rgba(90, 45, 35, 1);
            border-right-color: rgba(26, 11, 14, 1);
            border-bottom-color: rgba(26, 11, 14, 1);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            box-shadow:
                inset 0 1px 1px rgba(120, 60, 45, 0.7),
                inset 0 -1px 1px rgba(26, 11, 14, 0.8),
                2px 2px 4px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(58, 26, 24, 0.6);
        }

        .color-circle:hover {
            transform: none;
            border-top-color: rgba(120, 60, 45, 1);
            border-left-color: rgba(120, 60, 45, 1);
            border-right-color: rgba(26, 11, 14, 1);
            border-bottom-color: rgba(26, 11, 14, 1);
            box-shadow:
                inset 0 1px 2px rgba(150, 80, 60, 0.7),
                inset 0 -1px 2px rgba(26, 11, 14, 0.7),
                3px 3px 6px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(58, 26, 24, 0.5);
        }

        .color-circle:active,
        .color-circle.pressed {
            transform: none;
            border-top-color: rgba(26, 11, 14, 1);
            border-left-color: rgba(26, 11, 14, 1);
            border-right-color: rgba(90, 45, 35, 0.9);
            border-bottom-color: rgba(90, 45, 35, 0.9);
            box-shadow:
                inset 6px 6px 12px rgba(26, 11, 14, 1),
                inset -3px -3px 6px rgba(120, 60, 45, 0.4),
                0px 0px 1px rgba(47, 19, 24, 0.3);
        }

        .color-circle.white {
            background-color: #ffffff;
            box-shadow:
                inset 0 1px 1px rgba(120, 60, 45, 0.4),
                inset 0 -1px 2px rgba(26, 11, 14, 0.6),
                2px 2px 6px 1px rgba(47, 19, 24, 0.4);
        }

        .color-circle.white:active,
        .color-circle.white.pressed {
            box-shadow:
                inset 6px 6px 12px rgba(50, 30, 35, 0.8),
                inset -3px -3px 6px rgba(80, 50, 55, 0.6),
                0px 0px 1px rgba(50, 30, 35, 0.3);
        }

        .color-circle.beige {
            background-color: #F5F1E8;
        }

        .color-circle.green {
            background-color: #1F2C26;
        }

        .color-circle.navy {
            background-color: #001E32;
        }

        .nav-btn {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            font-weight: 500 !important;
            color: #F4E6D7;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background:
                linear-gradient(145deg, #52221F 0%, #34151A 50%, #1E0C0F 100%),
                linear-gradient(90deg, transparent 46%, rgba(74, 31, 31, 0.7) 50%, transparent 54%),
                linear-gradient(0deg, transparent 47%, rgba(47, 19, 24, 0.6) 50%, transparent 53%),
                linear-gradient(135deg, transparent 45%, rgba(90, 35, 25, 0.4) 50%, transparent 55%),
                linear-gradient(67deg, transparent 48%, rgba(30, 12, 8, 0.8) 52%, transparent 56%);
            background-size: 100% 100%, 2px 2px, 4px 4px, 8px 8px, 16px 16px;
            padding: 12px 20px;
            white-space: nowrap;
            border: 2px solid;
            border-top-color: rgba(90, 45, 35, 0.9);
            border-left-color: rgba(90, 45, 35, 0.9);
            border-right-color: rgba(26, 11, 14, 1);
            border-bottom-color: rgba(26, 11, 14, 1);
            box-shadow:
                inset 0 1px 1px rgba(120, 60, 45, 0.4),
                inset 0 -1px 2px rgba(26, 11, 14, 0.6),
                2px 2px 6px 1px rgba(47, 19, 24, 0.4);
            text-shadow: 1px 1px 3px rgba(26, 11, 14, 0.6);
            border-radius: 0;
        }

        .nav-btn:hover {
            color: #FFEECC;
            border-top-color: rgba(120, 60, 45, 1);
            border-left-color: rgba(120, 60, 45, 1);
            box-shadow:
                inset 0 1px 2px rgba(150, 80, 60, 0.5),
                inset 0 -1px 2px rgba(26, 11, 14, 0.7),
                2px 2px 8px 2px rgba(47, 19, 24, 0.5);
        }

        .nav-btn:active {
            border-top-color: rgba(26, 11, 14, 1);
            border-left-color: rgba(26, 11, 14, 1);
            border-right-color: rgba(90, 45, 35, 0.9);
            border-bottom-color: rgba(90, 45, 35, 0.9);
            box-shadow:
                inset 4px 4px 8px rgba(26, 11, 14, 0.9),
                inset -2px -2px 4px rgba(120, 60, 45, 0.1),
                0px 0px 1px rgba(47, 19, 24, 0.2);
        }

        .nav-icon-btn {
            position: relative;
            display: inline-flex;
            align-items: center;
            color: #F4E6D7;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background:
                linear-gradient(145deg, #52221F 0%, #34151A 50%, #1E0C0F 100%),
                linear-gradient(90deg, transparent 46%, rgba(74, 31, 31, 0.7) 50%, transparent 54%),
                linear-gradient(0deg, transparent 47%, rgba(47, 19, 24, 0.6) 50%, transparent 53%),
                linear-gradient(135deg, transparent 45%, rgba(90, 35, 25, 0.4) 50%, transparent 55%),
                linear-gradient(67deg, transparent 48%, rgba(30, 12, 8, 0.8) 52%, transparent 56%);
            background-size: 100% 100%, 2px 2px, 4px 4px, 8px 8px, 16px 16px;
            padding: 12px;
            border: 2px solid;
            border-top-color: rgba(90, 45, 35, 0.9);
            border-left-color: rgba(90, 45, 35, 0.9);
            border-right-color: rgba(26, 11, 14, 1);
            border-bottom-color: rgba(26, 11, 14, 1);
            box-shadow:
                inset 0 1px 1px rgba(120, 60, 45, 0.4),
                inset 0 -1px 2px rgba(26, 11, 14, 0.6),
                2px 2px 6px 1px rgba(47, 19, 24, 0.4);
            border-radius: 0;
        }

        .nav-icon-btn:hover {
            color: #FFEECC;
            border-top-color: rgba(120, 60, 45, 1);
            border-left-color: rgba(120, 60, 45, 1);
            box-shadow:
                inset 0 1px 2px rgba(150, 80, 60, 0.5),
                inset 0 -1px 2px rgba(26, 11, 14, 0.7),
                2px 2px 8px 2px rgba(47, 19, 24, 0.5);
        }

        .nav-icon-btn:active {
            border-top-color: rgba(26, 11, 14, 1);
            border-left-color: rgba(26, 11, 14, 1);
            border-right-color: rgba(90, 45, 35, 0.9);
            border-bottom-color: rgba(90, 45, 35, 0.9);
            box-shadow:
                inset 4px 4px 8px rgba(26, 11, 14, 0.9),
                inset -2px -2px 4px rgba(120, 60, 45, 0.1),
                0px 0px 1px rgba(47, 19, 24, 0.2);
        }

        .instagram-icon {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .hero-container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            padding: 400px 60px 0px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        .hero-title {
            font-family: 'EB Garamond', serif;
            font-size: 48px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 60px 0;
            color: #ff0000;
            line-height: 1.1;
            display: block;
            visibility: visible;
            opacity: 1;
        }

        .hero-divider {
            height: 1.5px;
            width: 100%;
            background-color: #000000;
            margin-bottom: 60px;
        }

        .hero-section.color-dark .hero-title {
            color: #ffffff;
        }

        .hero-section.color-dark .hero-divider {
            background-color: #ffffff;
        }

        .hero-section.color-beige .hero-title {
            color: #000000;
        }

        .hero-section.color-beige .hero-divider {
            background-color: #000000;
        }

        .hero-section.color-green .hero-title {
            color: #ffffff;
        }

        .hero-section.color-green .hero-divider {
            background-color: #ffffff;
        }

        .hero-section.color-navy .hero-title {
            color: #ffffff;
        }

        .hero-section.color-navy .hero-divider {
            background-color: #ffffff;
        }

        /* Body color classes for entire page background */
        body.color-beige {
            background-color: #F5F1E8;
        }

        body.color-navy {
            background-color: #001E32;
        }

        body.color-green {
            background-color: #1F2C26;
        }

        /* Container section styling for different themes */
        body.color-beige .container {
            background-color: #F5F1E8;
            color: #000000;
        }

        body.color-navy .container {
            background-color: #001E32;
            color: #ffffff;
        }

        body.color-green .container {
            background-color: #1F2C26;
            color: #ffffff;
        }

        /* Loading text color adjustments */
        body.color-navy .loading {
            color: #ffffff;
        }

        body.color-green .loading {
            color: #ffffff;
        }

        /* Tool card text colors for dark themes */
        body.color-navy .tool-name,
        body.color-green .tool-name {
            color: #ffffff;
        }

        body.color-navy .tool-description,
        body.color-green .tool-description {
            color: #ffffff;
        }

        body.color-navy .tool-meta,
        body.color-green .tool-meta {
            color: #cccccc;
        }

        /* Learn more button styling for dark themes */
        body.color-navy .learn-more-button,
        body.color-green .learn-more-button {
            color: #ffffff;
            border-color: #ffffff;
        }

        body.color-navy .learn-more-button:hover,
        body.color-green .learn-more-button:hover {
            background-color: #ffffff;
            color: #000000;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 60px 60px 60px;
        }

        .loading {
            text-align: center;
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            color: #666;
            margin: 40px 0;
        }

        .tools-grid {
            display: flex;
            flex-direction: column;
            gap: 0;
            margin-top: 40px;
        }

        .tool-card {
            padding: 30px 0 10px 0;
            transition: all 0.3s ease;
        }

        .tool-row {
            display: flex;
            align-items: flex-start;
            gap: 60px;
            margin-bottom: 16px;
        }

        .tool-left {
            flex: 0 0 280px;
        }

        .tool-logo {
            margin-bottom: 16px;
            display: block;
            text-decoration: none;
            transition: transform 0.2s ease;
        }

        .tool-logo:hover {
            transform: scale(1.05);
        }

        .tool-name-link {
            text-decoration: none;
            color: inherit;
            transition: color 0.2s ease;
        }

        .tool-name-link:hover {
            color: #BE5D1D;
        }

        .tool-app-logo {
            width: 80px;
            height: 80px;
            border-radius: 24px;
            object-fit: cover;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .tool-center {
            flex: 1;
        }

        .tool-right {
            flex: 0 0 80px;
            display: flex;
            align-items: flex-start;
            justify-content: flex-end;
        }

        .tool-name {
            font-family: 'Inter', sans-serif;
            font-size: 32px;
            font-weight: 700;
            margin: 0 0 4px 0;
            color: #000000;
        }

        .tool-meta {
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            font-weight: 500;
            margin: 0;
            color: #666666;
        }

        .tool-description {
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            font-weight: 400 !important;
            line-height: 1.6;
            color: #000000;
            margin: 0;
            max-width: none;
        }

        .tool-actions {
            display: flex;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        .app-store-button {
            display: inline-block;
            transition: transform 0.2s ease;
        }

        .app-store-button:hover {
            transform: scale(1.05);
        }

        .app-store-button .app-store-badge {
            width: 140px;
            height: auto;
        }

        .learn-more-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #000000;
            text-decoration: none;
            padding: 12px 20px;
            border: 2px solid #000000;
            border-radius: 8px;
            transition: all 0.2s ease;
            background-color: transparent;
        }

        .learn-more-button:hover {
            background-color: #000000;
            color: #ffffff;
            transform: translateY(-2px);
        }

        .arrow-icon {
            width: 18px;
            height: 18px;
            transition: transform 0.2s ease;
        }

        .learn-more-button:hover .arrow-icon {
            transform: translateX(2px);
        }

        @media (max-width: 768px) {
            .hero-container {
                padding: 400px 20px 0px 20px;
                min-height: auto;
            }

            .navigation-bar {
                gap: 0;
                padding: 0;
                top: 20px;
                left: 32px;
                right: 32px;
                width: calc(100vw - 64px);
                transform: none;
                flex-direction: column;
                align-items: center;
            }

            .nav-row-top, .nav-row-bottom {
                display: flex;
                align-items: stretch;
                gap: 0;
                width: 100%;
            }

            .nav-row-top {
                justify-content: center;
            }

            .nav-row-bottom {
                justify-content: center;
            }

            .nav-btn {
                font-size: 15px;
                font-weight: 600;
                padding: 14px 20px;
                flex: 1;
                text-align: center;
            }

            .nav-icon-btn {
                padding: 14px 16px;
                flex: 1;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .color-spinner-container {
                flex: 3;
                display: flex;
                justify-content: center;
            }

            .color-spinner {
                gap: 6px;
                padding: 14px 16px;
                width: 100%;
                justify-content: center;
                flex: 1;
            }

            .color-circle {
                width: auto;
                height: auto;
                aspect-ratio: 1;
                flex: 1;
                border-radius: 0;
            }

            .hero-title {
                font-size: 40px;
                margin-bottom: 40px;
            }

            .hero-divider {
                margin-bottom: 40px;
            }

            .container {
                padding: 0 20px 40px 20px;
            }

            .tool-card {
                padding: 40px 0;
            }

            .tool-row {
                flex-direction: column;
                gap: 20px;
                margin-bottom: 24px;
            }

            .tool-left {
                flex: none;
            }

            .tool-center {
                flex: none;
            }

            .tool-right {
                flex: none;
                justify-content: flex-start;
            }

            .tool-name {
                font-size: 28px;
            }

            .tool-meta {
                font-size: 16px;
            }

            .tool-description {
                font-size: 16px;
                font-weight: 400;
                margin-bottom: 12px;
            }

            .tool-actions {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .app-store-button .app-store-badge {
                width: 160px;
            }

            .learn-more-button {
                font-size: 14px;
                padding: 10px 16px;
            }
        }
    </style>
</head>
<body>
    <section class="hero-section">
        <div class="navigation-bar">
            <div class="nav-row-top">
                <a href="https://www.instagram.com/tools_a_cowboy_would_use/" target="_blank" class="nav-icon-btn">
                    <svg class="instagram-icon" viewBox="0 0 24 24">
                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.40s-.644-1.44-1.439-1.40z"/>
                    </svg>
                </a>

                <a href="https://blog.toolsacowboywoulduse.com" target="_blank" class="nav-btn">
                    Get notified
                </a>

                <a href="store/" target="_blank" class="nav-btn">
                    Store
                </a>
            </div>

            <div class="nav-row-bottom">
                <div class="color-spinner-container">
                    <div class="color-spinner">
                        <button class="color-circle beige" onclick="changeColor('beige')"></button>
                        <button class="color-circle navy" onclick="changeColor('navy')"></button>
                        <button class="color-circle green" onclick="changeColor('green')"></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-container">
            <h1 class="hero-title">Shelves</h1>
            <div class="hero-divider"></div>
        </div>
    </section>

    <div class="container">
        <div class="loading" id="loading">Loading apps...</div>
        <div class="tools-grid" id="tools-grid" style="display: none;"></div>
    </div>

    <script>
        // Google Sheets configuration (Public sheet - no API key needed)
        const SHEET_ID = '1EXPDGRvyutq8WpptlhrdlEH3ftJzw9bjk6kQtNBcQh4';
        const SHEET_NAME = 'Apps';

        // Function to extract App Store ID from URL
        function getAppStoreId(url) {
            const match = url.match(/id(\d+)/);
            return match ? match[1] : null;
        }

        // Function to get app metadata from App Store
        async function getAppMetadata(appStoreUrl) {
            try {
                const appId = getAppStoreId(appStoreUrl);
                if (!appId) return null;

                // Use iTunes Search API to get app metadata
                const response = await fetch(`https://itunes.apple.com/lookup?id=${appId}`);
                const data = await response.json();

                if (data.results && data.results.length > 0) {
                    const app = data.results[0];
                    console.log('App data:', app); // Debug log to see what fields we get
                    return {
                        name: app.trackName,
                        subtitle: app.sellerName || app.artistName || (app.formattedPrice === 'Free' ? 'Free' : app.formattedPrice),
                        icon: app.artworkUrl512, // High res icon
                        description: app.description,
                        appStoreDescription: app.description // Full App Store description
                    };
                }
            } catch (error) {
                console.error('Error fetching app metadata:', error);
            }
            return null;
        }

        // Function to convert image to WebP (placeholder - would need server-side conversion)
        function getAppIcon(iconUrl) {
            // For now, return the original icon URL
            // In production, you'd convert this to WebP server-side
            return iconUrl;
        }

        // Function to fetch and display recommendations
        async function loadRecommendations() {
            try {
                const response = await fetch(
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`
                );

                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }

                const text = await response.text();
                // Parse Google's JSON response (it has some extra stuff)
                const json = JSON.parse(text.substr(47).slice(0, -2));

                // Convert to simple array format
                const rows = json.table.rows.map(row =>
                    row.c.map(cell => cell ? cell.v : '')
                );

                displayRecommendations(rows);
            } catch (error) {
                console.error('Error loading recommendations:', error);
                document.getElementById('loading').textContent = 'Error loading recommendations. Please check the sheet ID and make sure the sheet is public.';
            }
        }

        async function displayRecommendations(data) {
            const loading = document.getElementById('loading');
            const grid = document.getElementById('tools-grid');

            if (data.length <= 1) {
                loading.textContent = 'No apps available yet.';
                return;
            }

            // Skip header row - expecting: Link, Name, Category, Description
            const apps = data.slice(1);

            // Process each app and get metadata
            const appCards = await Promise.all(apps.map(async ([appStoreUrl, manualName, category, ourDescription]) => {
                if (!appStoreUrl) return null;

                // Try to get app metadata from App Store
                const appMeta = await getAppMetadata(appStoreUrl);

                // Use App Store data if available, fallback to manual data
                const title = appMeta?.name || manualName || 'Unknown App';
                const creator = appMeta?.subtitle || category || '';
                const icon = appMeta?.icon ? getAppIcon(appMeta.icon) : `https://www.google.com/s2/favicons?domain=apps.apple.com&sz=64`;
                // Use only manual description
                const description = ourDescription || '';

                return `
                    <div class="tool-card">
                        <div class="tool-row">
                            <div class="tool-left">
                                <a href="${appStoreUrl}" target="_blank" class="tool-logo">
                                    <img src="${icon}" alt="${title} App Logo" class="tool-app-logo" onerror="this.src='https://www.google.com/s2/favicons?domain=apps.apple.com&sz=64'">
                                </a>
                                <a href="${appStoreUrl}" target="_blank" class="tool-name-link">
                                    <h3 class="tool-name">${title}</h3>
                                </a>
                                <p class="tool-meta">${creator}</p>
                            </div>
                            <div class="tool-center">
                                <p class="tool-description">
                                    ${description}
                                </p>
                            </div>
                            <div class="tool-right">
                                <a href="${appStoreUrl}" target="_blank" class="app-store-button">
                                    <img src="images/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg" alt="Download on the App Store" class="app-store-badge">
                                </a>
                            </div>
                        </div>
                    </div>
                `;
            }));

            // Filter out null entries and join
            grid.innerHTML = appCards.filter(card => card !== null).join('');

            loading.style.display = 'none';
            grid.style.display = 'flex';
        }

        // Color values for theme-color and body background
        const colorValues = {
            beige: '#F5F1E8',
            navy: '#001E32',
            green: '#1F2C26'
        };

        // Color switcher functionality
        function changeColor(colorName) {
            const heroSection = document.querySelector('.hero-section');
            const allCircles = document.querySelectorAll('.color-circle');
            const themeColor = document.querySelector('meta[name="theme-color"]');

            // Remove all color classes from hero and body
            heroSection.classList.remove('color-beige', 'color-green', 'color-navy');
            document.body.classList.remove('color-beige', 'color-green', 'color-navy');

            // Remove pressed state from all circles
            allCircles.forEach(circle => {
                circle.classList.remove('pressed');
            });

            // Add new color class to both hero and body
            heroSection.classList.add(`color-${colorName}`);
            document.body.classList.add(`color-${colorName}`);

            // Add pressed state to active circle
            const activeCircle = document.querySelector(`.color-circle.${colorName}`);
            if (activeCircle) {
                activeCircle.classList.add('pressed');
            }

            // Update theme color for browser UI
            themeColor.content = colorValues[colorName];

            // Update body background to match
            document.body.style.backgroundColor = colorValues[colorName];
        }

        // Set default color and load recommendations on page load
        document.addEventListener('DOMContentLoaded', function() {
            changeColor('beige');
            loadRecommendations();
        });
    </script>
</body>
</html>